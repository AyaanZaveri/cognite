(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[572],{8045:function(e,t,n){Promise.resolve().then(n.bind(n,2129)),Promise.resolve().then(n.bind(n,4253)),Promise.resolve().then(n.t.bind(n,5593,23))},4253:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return J}});var s=n(4953),r=n(4680),a=n.n(r),l=n(599),i=n(4927),o=n(9979),c=n(6649),d=n(8751),u=n(2447),h=n(8352),p=n(5722),f=n(7877),m=n(3868),x=n(5749),v=n(1985),g=n(2558),b=n.n(g),j=n(1719),y=n(2006),k=n.n(y),w=n(317),_=n(1036),N=n(7413),D=n(1689),S=n(5239),C=n(6005),E=n(9466);let I="Switch",[z,P]=(0,D.b)(I),[R,W]=z(I),T=(0,p.forwardRef)((e,t)=>{let{__scopeSwitch:n,name:s,checked:r,defaultChecked:a,required:l,disabled:i,value:o="on",onCheckedChange:c,...d}=e,[u,h]=(0,p.useState)(null),f=(0,N.e)(t,e=>h(e)),m=(0,p.useRef)(!1),x=!u||!!u.closest("form"),[v=!1,g]=(0,S.T)({prop:r,defaultProp:a,onChange:c});return(0,p.createElement)(R,{scope:n,checked:v,disabled:i},(0,p.createElement)(E.WV.button,(0,w.Z)({type:"button",role:"switch","aria-checked":v,"aria-required":l,"data-state":O(v),"data-disabled":i?"":void 0,disabled:i,value:o},d,{ref:f,onClick:(0,_.M)(e.onClick,e=>{g(e=>!e),x&&(m.current=e.isPropagationStopped(),m.current||e.stopPropagation())})})),x&&(0,p.createElement)(G,{control:u,bubbles:!m.current,name:s,value:o,checked:v,required:l,disabled:i,style:{transform:"translateX(-100%)"}}))}),F=(0,p.forwardRef)((e,t)=>{let{__scopeSwitch:n,...s}=e,r=W("SwitchThumb",n);return(0,p.createElement)(E.WV.span,(0,w.Z)({"data-state":O(r.checked),"data-disabled":r.disabled?"":void 0},s,{ref:t}))}),G=e=>{let{control:t,checked:n,bubbles:s=!0,...r}=e,a=(0,p.useRef)(null),l=function(e){let t=(0,p.useRef)({value:e,previous:e});return(0,p.useMemo)(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}(n),i=(0,C.t)(t);return(0,p.useEffect)(()=>{let e=a.current,t=window.HTMLInputElement.prototype,r=Object.getOwnPropertyDescriptor(t,"checked"),i=r.set;if(l!==n&&i){let t=new Event("click",{bubbles:s});i.call(e,n),e.dispatchEvent(t)}},[l,n,s]),(0,p.createElement)("input",(0,w.Z)({type:"checkbox","aria-hidden":!0,defaultChecked:n},r,{tabIndex:-1,ref:a,style:{...e.style,...i,position:"absolute",pointerEvents:"none",opacity:0,margin:0}}))};function O(e){return e?"checked":"unchecked"}let A=p.forwardRef((e,t)=>{let{className:n,...r}=e;return(0,s.jsx)(T,{className:(0,f.cn)("peer inline-flex h-[20px] w-[36px] shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",n),...r,ref:t,children:(0,s.jsx)(F,{className:(0,f.cn)("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})})});A.displayName=T.displayName;var U=n(2787);let X=o.IX(o.Ry({value:o.Z_().min(2,{message:"Tag must be at least 2 characters long"}).max(20,{message:"Tag must be at most 20 characters long"})})).optional(),Z=o.Ry({name:o.Z_().min(3,{message:"Your name must be at least 3 characters long"}).max(30,{message:"It's a name, not a poem (max 30 characters)"}),description:o.Z_().max(300,{message:"It's a description, not an essay (max 300 characters)"}).optional(),imgUrl:o.Z_().max(200,{message:"Your image URL is too long (max 200 characters)"}).optional(),tags:X,websites:o.IX(o.Ry({value:o.Z_().url({message:"Please enter a valid URL."})})).optional(),file:o.Z_().optional(),private:o.O7().optional()});var J=e=>{var t,n;let r=(0,i.cI)({resolver:(0,l.F)(Z),mode:"onChange"}),{fields:o,append:g}=(0,i.Dq)({name:"tags",control:r.control}),{fields:y,append:w}=(0,i.Dq)({name:"websites",control:r.control}),[_,N]=(0,p.useState)({text:"Create",disabled:!1,pulse:!1}),D=(0,U.useRouter)(),[S,C]=(0,p.useState)(null);async function E(e){try{if((null==e?void 0:e.sites).length>0||S){N({text:"Getting sources \uD83C\uDF0E",disabled:!0,pulse:!0});let t=[];if((null==e?void 0:e.sites)&&(null==e?void 0:e.sites.length)>0){let n=await (0,m.T)(null==e?void 0:e.sites),s=new x.s9({chunkSize:1e3,chunkOverlap:200}),r=await s.createDocuments([n]);t.push(...r)}if(S){let e=new x.s9({chunkSize:1e3,chunkOverlap:200}),n=new v.u(S),s=await n.loadAndSplit(e);t.push(...s)}return N({text:"Creating cog \uD83E\uDDE0",disabled:!0,pulse:!0}),t}N({text:"No sources provided \uD83D\uDE22",disabled:!1,pulse:!1})}catch(e){console.log("error",e),N({text:"Error getting sources \uD83D\uDE22",disabled:!1,pulse:!1})}}async function I(t){var n,s,r,a;let l={sites:null===(n=t.websites)||void 0===n?void 0:n.map(e=>e.value),files:t.file},i=await E(l),o={name:t.name,description:t.description,imgUrl:t.imgUrl,tags:null===(s=t.tags)||void 0===s?void 0:s.map(e=>e.value),docs:i,slug:b()(t.name,{lower:!0}),userId:null==e?void 0:null===(a=e.session)||void 0===a?void 0:null===(r=a.user)||void 0===r?void 0:r.id,isPrivate:t.private};await j.Z.post("/api/cog/create",{data:o}).then(t=>{var n;N({text:"Cog created! \uD83C\uDF89",disabled:!0,pulse:!1}),D.push("/cog/".concat(null==e?void 0:null===(n=e.session)||void 0===n?void 0:n.user.username,"/").concat(t.data.cog.slug))}).catch(e=>{N({text:"Error creating cog \uD83D\uDE22",disabled:!1,pulse:!1}),console.log(e)})}let z=async e=>{if(e.target.files)try{var t;let n=null===(t=e.target.files)||void 0===t?void 0:t[0];if(n){let e=await n.arrayBuffer(),t=new Blob([new Uint8Array(e)],{type:n.type});C(t)}}catch(e){console.log("err",e)}};return(0,s.jsx)("div",{className:"space-y-8",children:(0,s.jsx)(c.l0,{...r,children:(0,s.jsxs)("form",{className:"space-y-4",onSubmit:r.handleSubmit(I),children:[(0,s.jsx)(c.Wi,{control:r.control,name:"name",render:e=>{let{field:t}=e;return(0,s.jsxs)(c.xJ,{children:[(0,s.jsx)(c.lX,{children:"Name"}),(0,s.jsx)(c.NI,{children:(0,s.jsx)(u.I,{placeholder:"Name",...t})}),(0,s.jsx)(c.pf,{children:"This is the name of the cog."}),(0,s.jsx)(c.zG,{})]})}}),(0,s.jsxs)("div",{children:[y.map((e,t)=>(0,s.jsx)(c.Wi,{control:r.control,name:"websites.".concat(t,".value"),render:e=>{let{field:n}=e;return(0,s.jsxs)(c.xJ,{children:[(0,s.jsx)(c.lX,{className:(0,f.cn)(0!==t&&"sr-only"),children:"Websites"}),(0,s.jsx)(c.pf,{className:(0,f.cn)(0!==t&&"sr-only"),children:"Websites you want to train the cog on."}),(0,s.jsx)(c.NI,{children:(0,s.jsx)(u.I,{...n})}),(0,s.jsx)(c.zG,{})]})}},e.id)),(0,s.jsx)(h.z,{type:"button",variant:"outline",size:"sm",className:"mt-2",onClick:()=>w({value:""}),children:"Add Website"})]}),(0,s.jsx)(c.Wi,{control:r.control,name:"file",render:e=>{let{field:t}=e;return(0,s.jsxs)(c.xJ,{children:[(0,s.jsx)(c.lX,{children:"Files"}),(0,s.jsx)(c.NI,{children:(0,s.jsx)(u.I,{type:"file",placeholder:"File",...t,onChange:z})}),(0,s.jsx)(c.pf,{children:"You can also upload a PDF"}),(0,s.jsx)(c.zG,{})]})}}),(0,s.jsx)(c.Wi,{control:r.control,name:"private",render:e=>{let{field:t}=e;return(0,s.jsxs)(c.xJ,{children:[(0,s.jsxs)("div",{className:"inline-flex items-center gap-2",children:[(0,s.jsx)(c.lX,{children:"Private"}),(0,s.jsx)(c.NI,{children:(0,s.jsx)(A,{checked:t.value,onCheckedChange:t.onChange})})]}),(0,s.jsx)(c.pf,{children:t.value?"Your cog is private ~ Only you can see it \uD83D\uDC40":"Your cog is public ~ It can be discovered \uD83C\uDF0E"}),(0,s.jsx)(c.zG,{})]})}}),(0,s.jsx)(c.Wi,{control:r.control,name:"description",render:e=>{let{field:t}=e;return(0,s.jsxs)(c.xJ,{children:[(0,s.jsx)(c.lX,{children:"Description"}),(0,s.jsx)(c.NI,{children:(0,s.jsx)(d.g,{placeholder:"Description",...t})}),(0,s.jsx)(c.pf,{children:"A short description of the cog."}),(0,s.jsx)(c.zG,{})]})}}),(0,s.jsxs)("div",{children:[o.map((e,t)=>(0,s.jsx)(c.Wi,{control:r.control,name:"tags.".concat(t,".value"),render:e=>{var n,a,l;let{field:i}=e;return(0,s.jsxs)(c.xJ,{children:[(0,s.jsx)(c.lX,{className:(0,f.cn)(0!==t&&"sr-only"),children:"Tags"}),(0,s.jsx)(c.pf,{className:(0,f.cn)(0!==t&&"sr-only"),children:"Tags are used to help people find your cog."}),(0,s.jsx)(c.NI,{children:(0,s.jsx)(u.I,{...i})}),(0,s.jsx)(c.zG,{children:null===(l=r.formState.errors.tags)||void 0===l?void 0:null===(a=l[t])||void 0===a?void 0:null===(n=a.value)||void 0===n?void 0:n.message})]})}},e.id)),(0,s.jsx)(h.z,{type:"button",variant:"outline",size:"sm",className:"mt-2",onClick:()=>g({value:""}),children:"Add Tag"})]}),(0,s.jsx)(c.Wi,{control:r.control,name:"imgUrl",render:e=>{let{field:t}=e;return(0,s.jsxs)(c.xJ,{children:[(0,s.jsx)(c.lX,{children:"Image URL"}),(0,s.jsx)(c.NI,{children:(0,s.jsx)(u.I,{placeholder:"Image URL",...t})}),(0,s.jsx)(c.pf,{children:"A URL to an image of the cog."}),(0,s.jsx)(c.zG,{})]})}}),(null==e?void 0:null===(n=e.session)||void 0===n?void 0:null===(t=n.user)||void 0===t?void 0:t.id)?(0,s.jsx)(h.z,{type:"submit",className:"".concat(a().className),children:(0,s.jsx)("span",{className:(0,f.cn)(_.pulse&&"animate-pulse",_.disabled&&"cursor-not-allowed"),children:_.text})}):(0,s.jsx)("div",{children:(0,s.jsx)(k(),{href:"/api/auth/signin",children:(0,s.jsx)(h.z,{type:"button",className:"".concat(a().className),children:"Sign in to create a cog"})})})]})})})}},3868:function(e,t,n){"use strict";n.d(t,{T:function(){return s}});let s=async e=>{let t=await fetch("/api/extract",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({urls:e})}),n=await t.json();return n.extracted_text}},5593:function(e){e.exports={style:{fontFamily:"'__Space_Grotesk_e75d16', '__Space_Grotesk_Fallback_e75d16'",fontStyle:"normal"},className:"__className_e75d16"}},4680:function(e){e.exports={style:{fontFamily:"'__Space_Grotesk_e75d16', '__Space_Grotesk_Fallback_e75d16'",fontStyle:"normal"},className:"__className_e75d16"}},2006:function(e,t,n){e.exports=n(448)},1036:function(e,t,n){"use strict";function s(e,t,{checkForDefaultPrevented:n=!0}={}){return function(s){if(null==e||e(s),!1===n||!s.defaultPrevented)return null==t?void 0:t(s)}}n.d(t,{M:function(){return s}})},5239:function(e,t,n){"use strict";n.d(t,{T:function(){return a}});var s=n(5722),r=n(449);function a({prop:e,defaultProp:t,onChange:n=()=>{}}){let[a,l]=function({defaultProp:e,onChange:t}){let n=(0,s.useState)(e),[a]=n,l=(0,s.useRef)(a),i=(0,r.W)(t);return(0,s.useEffect)(()=>{l.current!==a&&(i(a),l.current=a)},[a,l,i]),n}({defaultProp:t,onChange:n}),i=void 0!==e,o=i?e:a,c=(0,r.W)(n),d=(0,s.useCallback)(t=>{if(i){let n="function"==typeof t?t(e):t;n!==e&&c(n)}else l(t)},[i,e,l,c]);return[o,d]}},6005:function(e,t,n){"use strict";n.d(t,{t:function(){return a}});var s=n(5722),r=n(197);function a(e){let[t,n]=(0,s.useState)(void 0);return(0,r.b)(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let s,r;if(!Array.isArray(t)||!t.length)return;let a=t[0];if("borderBoxSize"in a){let e=a.borderBoxSize,t=Array.isArray(e)?e[0]:e;s=t.inlineSize,r=t.blockSize}else s=e.offsetWidth,r=e.offsetHeight;n({width:s,height:r})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}n(void 0)},[e]),t}}},function(e){e.O(0,[507,301,726,193,805,549,506,744],function(){return e(e.s=8045)}),_N_E=e.O()}]);